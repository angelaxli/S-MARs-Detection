Portion of code from ASDRP Project
